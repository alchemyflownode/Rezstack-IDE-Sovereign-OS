'use client';import React, { useState, useEffect } from 'react';import { motion, AnimatePresence } from 'framer-motion';import Splitter from './Splitter';interface PanelConfig {  id: string;  defaultSize: number;  minSize: number;  maxSize: number;  collapsedSize?: number;  collapsible?: boolean;}interface EnhancedResizableLayoutProps {  left: React.ReactNode;  right: React.ReactNode;  bottom?: React.ReactNode;  leftConfig?: PanelConfig;  rightConfig?: PanelConfig;  bottomConfig?: PanelConfig;  className?: string;  onLayoutChange?: (layout: { leftWidth: number; bottomHeight?: number }) => void;}export const EnhancedResizableLayout: React.FC<EnhancedResizableLayoutProps> = ({  left,  right,  bottom,  leftConfig = { id: 'left', defaultSize: 25, minSize: 15, maxSize: 50 },  rightConfig = { id: 'right', defaultSize: 75, minSize: 50, maxSize: 85 },  bottomConfig = { id: 'bottom', defaultSize: 30, minSize: 15, maxSize: 60, collapsible: true },  className = '',  onLayoutChange}) => {  const [mounted, setMounted] = useState(false);  const [leftWidth, setLeftWidth] = useState(leftConfig.defaultSize);  const [bottomHeight, setBottomHeight] = useState(bottom ? bottomConfig.defaultSize : 0);  const [isBottomCollapsed, setIsBottomCollapsed] = useState(false);  const [isDragging, setIsDragging] = useState<string | null>(null);  // Load from localStorage only on client  useEffect(() => {    setMounted(true);    const savedLeft = localStorage.getItem(`layout-${leftConfig.id}`);    if (savedLeft) {      setLeftWidth(parseInt(savedLeft));    }    if (bottom) {      const savedBottom = localStorage.getItem(`layout-${bottomConfig.id}`);      if (savedBottom) {        setBottomHeight(parseInt(savedBottom));      }    }  }, [leftConfig.id, bottomConfig.id, bottom]);  // Save layout changes  useEffect(() => {    if (!mounted) return;    localStorage.setItem(`layout-${leftConfig.id}`, leftWidth.toString());    if (bottom) {      localStorage.setItem(`layout-${bottomConfig.id}`, bottomHeight.toString());    }    onLayoutChange?.({ leftWidth, bottomHeight: bottom ? bottomHeight : undefined });  }, [leftWidth, bottomHeight, bottom, leftConfig.id, bottomConfig.id, onLayoutChange, mounted]);  const handleLeftDrag = (delta: number) => {    if (!mounted) return;    const newWidth = leftWidth + (delta / window.innerWidth) * 100;    setLeftWidth(Math.min(Math.max(newWidth, leftConfig.minSize), leftConfig.maxSize));  };  const handleBottomDrag = (delta: number) => {    if (!mounted) return;    const newHeight = bottomHeight - (delta / window.innerHeight) * 100;    setBottomHeight(Math.min(Math.max(newHeight, bottomConfig.minSize), bottomConfig.maxSize));  };  const toggleBottom = () => {    if (!bottomConfig.collapsible) return;    setIsBottomCollapsed(!isBottomCollapsed);    if (!isBottomCollapsed) {      localStorage.setItem(`layout-${bottomConfig.id}-expanded`, bottomHeight.toString());      setBottomHeight(bottomConfig.collapsedSize || 5);    } else {      const saved = localStorage.getItem(`layout-${bottomConfig.id}-expanded`);      setBottomHeight(saved ? parseInt(saved) : bottomConfig.defaultSize);    }  };  // Don't animate until mounted to prevent hydration mismatch  const animationProps = mounted ? {    animate: { width: `${leftWidth}%` },    transition: { type: 'spring', stiffness: 300, damping: 30 }  } : {};  return (    <div className={`flex md:flex flex md:flex-col h-full w-full ${className}`}>      <div        className="flex md:flex w-full relative"        style={{ height: bottom ? `calc(100% - ${bottomHeight}%)` : '100%' }}      >        {/* Left panel */}        <motion.div          className="h-full overflow-hidden"          style={{ width: `${leftWidth}%` }}          {...animationProps}        >          {left}        </motion.div>        <Splitter          axis="vertical"          onDrag={handleLeftDrag}          onDragStart={() => setIsDragging('left')}          onDragEnd={() => setIsDragging(null)}          size="md"          glowIntensity={isDragging === 'left' ? 'high' : 'medium'}        />        {/* Right panel */}        <motion.div          className="flex md:flex-1 h-full overflow-hidden"          animate={mounted ? { width: `${100 - leftWidth}%` } : {}}          transition={{ type: 'spring', stiffness: 300, damping: 30 }}        >          {right}        </motion.div>      </div>      <AnimatePresence>        {bottom && (          <motion.div            className="relative w-full mt-2"            initial={false}            animate={{ height: `${isBottomCollapsed ? 5 : bottomHeight}%` }}            transition={{ type: 'spring', stiffness: 300, damping: 30 }}          >            <div className="absolute -top-2 md:p-6 left-1/2 transform -translate-x-1/2 flex md:flex items-center gap-2 md:p-2 z-20">              <button aria-label="Action button"                 onClick={toggleBottom}                className="px-3 py-1 bg-purple-500/20 hover:bg-purple-500/30 rounded-t-lg text-sm md:text-xs text-sm md:text-purple-300 border border-purple-500/30 border-b-0 transition-colors"              >                {isBottomCollapsed ? '? Expand Terminal' : '? Collapse Terminal'}              </button>            </div>            {!isBottomCollapsed && (              <Splitter                axis="horizontal"                onDrag={handleBottomDrag}                onDragStart={() => setIsDragging('bottom')}                onDragEnd={() => setIsDragging(null)}                size="sm"                glowIntensity={isDragging === 'bottom' ? 'high' : 'medium'}              />            )}            <div className="h-full w-full overflow-hidden mt-1">              {bottom}            </div>          </motion.div>        )}      </AnimatePresence>    </div>  );};