// src/app/rez-dashboard/page.tsx
'use client';

import { useState, useEffect } from 'react';
import Link from 'next/link';
import RezSwarmHive from '@/components/RezSwarmHive';
import {
  ArrowLeft, Activity, Cpu, Shield, Brain,
  FileText, Zap, TrendingUp, Heart, LayoutDashboard,
  FolderTree, Code, Settings, BookOpen, Globe,
  Bot, Sparkles, GitBranch, Database, Lock,
  Users, Network, Workflow, Box, Command
} from 'lucide-react';

export default function RezDashboard() {
  const [stats, setStats] = useState({
    scripts: { total: 60, sovereign: 0, quarantined: 0 },
    models: 25,
    memory: 1,
    constitution: 8,
    agents: 4,
    skills: 12,
    commands: 8,
    integrations: 5
  });

  const [services, setServices] = useState([
    { name: 'Swarm API', port: 8000, status: 'running', type: 'agent' },
    { name: 'Constitutional Bridge', port: 8001, status: 'running', type: 'governance' },
    { name: 'JARVIS API', port: 8002, status: 'running', type: 'ai' },
    { name: 'Sovereign API', port: 9000, status: 'running', type: 'core' },
    { name: 'JARVIS IDE', port: 8080, status: 'starting', type: 'ui' }
  ]);

  useEffect(() => {
    fetch('/api/agent/memory')
      .then(res => res.json())
      .then(data => {
        if (Array.isArray(data)) {
          setStats(prev => ({ ...prev, memory: data.length }));
        }
      })
      .catch(() => {});
  }, []);

  // ... (keep all your existing commands, skills, agents, capabilities arrays)

  return (
    <div className="min-h-screen bg-[#0b0b0b] text-[#cccccc] font-sans">
      {/* VS Code Style Header */}
      <header className="h-11 flex items-center justify-between px-3 border-b border-[#252525] bg-[#181818]">
        <div className="flex items-center gap-3">
          <Link
            href="/"
            className="flex items-center gap-1 px-2 py-1 hover:bg-[#2a2d2e] rounded transition-colors text-[#858585] hover:text-white"
          >
            <ArrowLeft className="w-4 h-4" />
            <span className="text-[11px]">Back to IDE</span>
          </Link>
          <div className="w-px h-4 bg-[#252525]" />
          <div className="flex items-center gap-2">
            <div className="w-5 h-5 bg-purple-600 rounded flex items-center justify-center">
              <span className="text-white text-[10px] font-bold">R</span>
            </div>
            <span className="text-xs font-semibold text-[#e1e1e1]">RezStack Dashboard</span>
          </div>
        </div>
        <div className="flex items-center gap-2 px-2 py-1 bg-[#1e1e1e] rounded text-[10px] text-[#858585] border border-[#252525]">
          <div className="w-2 h-2 rounded-full bg-green-500/80 shadow-[0_0_8px_rgba(34,197,94,0.4)]" />
          <span>v4.2 ‚Ä¢ {stats.agents} Agents ‚Ä¢ {stats.skills} Skills ‚Ä¢ {stats.memory} Crystals</span>
        </div>
      </header>

      {/* Main Content */}
      <main className="p-6 overflow-auto max-h-[calc(100vh-44px)]">
        {/* Stats Grid */}
        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
          {/* ... keep your existing stats grid ... */}
        </div>

        {/* Ecosystem Status */}
        <div className="mb-8 bg-[#181818] border border-[#252525] rounded-lg p-4">
          {/* ... keep your existing ecosystem status ... */}
        </div>

        {/* üêù REZSWARM HIVE VISUALIZATION */}
        <div className="mb-8 bg-[#181818] border border-[#252525] rounded-lg p-4">
          <h3 className="text-xs font-bold text-purple-400 uppercase tracking-wider mb-3 flex items-center gap-2">
            <Activity className="w-4 h-4" />
            REZSWARM HIVE ‚Ä¢ Living Agent Visualization
          </h3>
          <div className="h-[500px] w-full bg-[#0b0b0b] rounded-lg border border-[#252525] overflow-hidden">
            <RezSwarmHive />
          </div>
          <p className="text-[10px] text-[#555] mt-2 text-center">
            32 autonomous agents ‚Ä¢ Boids physics ‚Ä¢ Intent propagation ‚Ä¢ Real-time coherence
          </p>
        </div>

        {/* Capabilities Grid */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          {/* ... keep your existing capabilities ... */}
        </div>

        {/* Commands Table */}
        <div className="mb-8 bg-[#181818] border border-[#252525] rounded-lg p-4">
          {/* ... keep your existing commands ... */}
        </div>

        {/* Agents Grid */}
        <div className="mb-8 bg-[#181818] border border-[#252525] rounded-lg p-4">
          {/* ... keep your existing agents ... */}
        </div>

        {/* Skills Matrix */}
        <div className="mb-8 bg-[#181818] border border-[#252525] rounded-lg p-4">
          {/* ... keep your existing skills ... */}
        </div>

        {/* Quick Actions */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          {/* ... keep your existing quick actions ... */}
        </div>

        {/* Script Categories */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          {/* ... keep your existing script categories ... */}
        </div>

        {/* Status Bar */}
        <footer className="mt-8 h-6 flex items-center justify-between px-3 bg-[#007acc] text-white text-[11px] rounded">
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-1">
              <Cpu className="w-3 h-3" />
              <span>RTX 3060</span>
            </div>
            <span>{stats.models} models active</span>
            <span>{stats.constitution} constitutional articles</span>
            <span>{stats.agents} agents</span>
            <span>{stats.skills} skills</span>
          </div>
          <div className="flex items-center gap-4">
            <span>The Rez Way ‚Ä¢ Zero Drift</span>
            <span className="font-mono opacity-80">v4.2</span>
          </div>
        </footer>
      </main>
    </div>
  );
}